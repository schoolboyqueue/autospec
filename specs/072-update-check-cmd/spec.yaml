feature:
    branch: "072-update-check-cmd"
    created: "2025-12-21"
    status: "Completed"
    completed_at: 2025-12-21T23:01:59Z
    input: "i dont like how 'autospec version' is used to check for updates - it should be another seperate command instead - and should be minimalistic name but still accurate"
user_stories:
    - id: "US-001"
      title: "Quick update availability check"
      priority: "P1"
      as_a: "CLI user"
      i_want: "to check if a newer version of autospec is available using a dedicated command"
      so_that: "I can quickly see update status without extra version info"
      why_this_priority: "Core feature request - the primary ask from user"
      independent_test: "Run the new command and verify it outputs update availability status"
      acceptance_scenarios:
        - given: "autospec is running a released version and a newer version exists on GitHub"
          when: "user runs the new check command"
          then: "command displays the current version, available version, and suggests running 'autospec update'"
        - given: "autospec is running the latest version"
          when: "user runs the new check command"
          then: "command displays a message confirming user is on the latest version"
        - given: "user is running a dev build"
          when: "user runs the new check command"
          then: "command indicates dev builds don't receive update checks"
    - id: "US-002"
      title: "Clean version display without update noise"
      priority: "P1"
      as_a: "CLI user"
      i_want: "the version command to only show version information"
      so_that: "version output is predictable and not delayed by network requests"
      why_this_priority: "Part of separation of concerns - version should be instant"
      independent_test: "Run 'autospec version' and confirm no update check occurs"
      acceptance_scenarios:
        - given: "user wants to see version info"
          when: "user runs 'autospec version'"
          then: "version info displays immediately without any network calls or update notifications"
        - given: "autospec version output is used in scripts"
          when: "user runs 'autospec version --plain'"
          then: "output is deterministic with no update-related content"
requirements:
    functional:
        - id: "FR-001"
          description: "MUST add a new CLI command for checking update availability"
          testable: true
          acceptance_criteria: "New command exists and is callable from CLI"
        - id: "FR-002"
          description: "MUST remove async update check from 'autospec version' command"
          testable: true
          acceptance_criteria: "'autospec version' no longer makes any network requests"
        - id: "FR-003"
          description: "MUST display current version and latest available version when update exists"
          testable: true
          acceptance_criteria: "Output shows 'v1.0.0 -> v1.1.0' style comparison when update available"
        - id: "FR-004"
          description: "MUST display confirmation message when already on latest version"
          testable: true
          acceptance_criteria: "Output shows 'Already on latest version (vX.Y.Z)' or similar"
        - id: "FR-005"
          description: "MUST handle dev builds gracefully"
          testable: true
          acceptance_criteria: "Dev builds show informative message about update checks not applying"
        - id: "FR-006"
          description: "MUST handle network errors gracefully"
          testable: true
          acceptance_criteria: "Network failures produce user-friendly error messages"
        - id: "FR-007"
          description: "SHOULD use a short, memorable command name (2-4 characters)"
          testable: true
          acceptance_criteria: "Command name is concise (suggestion: 'ck' for 'check')"
        - id: "FR-008"
          description: "MUST pass all quality gates: make test, make fmt, make lint, and make build"
          testable: true
          acceptance_criteria: "All commands exit 0; no test failures, format changes, lint errors, or build failures"
    non_functional:
        - id: "NFR-001"
          category: "performance"
          description: "Update check should complete within reasonable network timeout"
          measurable_target: "Check completes or times out within 5 seconds"
        - id: "NFR-002"
          category: "usability"
          description: "Command name should be intuitive and discoverable"
          measurable_target: "Command appears in 'autospec --help' with clear description"
        - id: "NFR-003"
          category: "code_quality"
          description: "All functions must be under 40 lines; extract helpers for complex logic"
          measurable_target: "No function exceeds 40 lines excluding comments"
        - id: "NFR-004"
          category: "code_quality"
          description: "All errors must be wrapped with context using fmt.Errorf(\"doing X: %w\", err)"
          measurable_target: "Zero bare 'return err' statements in new code"
        - id: "NFR-005"
          category: "code_quality"
          description: "Tests must use map-based table-driven pattern with t.Parallel()"
          measurable_target: "All new test functions use map[string]struct pattern and call t.Parallel()"
        - id: "NFR-006"
          category: "code_quality"
          description: "Accept interfaces, return concrete types"
          measurable_target: "Function signatures follow interface-in, concrete-out pattern where applicable"
success_criteria:
    measurable_outcomes:
        - id: "SC-001"
          description: "Users can check for updates with a single short command"
          metric: "Command name character count"
          target: "2-4 characters (e.g., 'ck')"
        - id: "SC-002"
          description: "Version command no longer has network-induced latency"
          metric: "'autospec version' execution time"
          target: "Completes in under 100ms (no network calls)"
        - id: "SC-003"
          description: "Update status is clearly communicated to users"
          metric: "Output clarity"
          target: "Shows current version, latest version (if different), and next action"
key_entities:
    - name: "CheckCommand"
      description: "New CLI command for checking update availability"
      attributes:
        - "Command name and aliases"
        - "Output format (pretty vs plain)"
        - "Exit codes for scripting"
    - name: "UpdateChecker"
      description: "Existing service for querying GitHub releases"
      attributes:
        - "HTTP timeout configuration"
        - "Version comparison logic"
edge_cases:
    - scenario: "GitHub API rate limit exceeded"
      expected_behavior: "Display user-friendly message suggesting retry later"
    - scenario: "No network connectivity"
      expected_behavior: "Timeout gracefully with actionable error message"
    - scenario: "GitHub releases endpoint returns 404"
      expected_behavior: "Inform user no releases found"
    - scenario: "Current version format is unparseable"
      expected_behavior: "Display error with current version string for debugging"
assumptions:
    - "The existing 'autospec update' command for downloading/installing updates will remain unchanged"
    - "The new command will reuse the existing update.Checker infrastructure"
    - "Command will be placed in 'internal/cli/util/' alongside version.go"
    - "Command name 'ck' (check) is acceptable as it's minimalistic yet accurate"
    - "No new dependencies are required"
constraints:
    - "Must not break existing 'autospec update' command behavior"
    - "Must maintain backward compatibility for scripts using 'autospec version --plain'"
    - "Must work on all supported platforms (Linux, macOS)"
out_of_scope:
    - "Automatic update installation (handled by existing 'autospec update')"
    - "Notification system for background update checks"
    - "Changelog display for available updates"
    - "Interactive update prompts"
_meta:
    version: "1.0.0"
    generator: "autospec"
    generator_version: "autospec dev"
    created: "2025-12-21T21:07:40Z"
    artifact_type: "spec"
