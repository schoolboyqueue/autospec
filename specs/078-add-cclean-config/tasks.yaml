tasks:
    branch: "078-add-cclean-config"
    created: "2026-01-02"
    spec_path: "specs/078-add-cclean-config/spec.yaml"
    plan_path: "specs/078-add-cclean-config/plan.yaml"
summary:
    total_tasks: 12
    total_phases: 5
    parallel_opportunities: 4
    estimated_complexity: "medium"
phases:
    - number: 1
      title: "Setup"
      purpose: "Create new CcleanConfig type file"
      tasks:
        - id: "T001"
          title: "Create internal/config/cclean.go with CcleanConfig struct"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: "internal/config/cclean.go"
          dependencies: []
          acceptance_criteria:
            - "CcleanConfig struct defined with Verbose (bool), LineNumbers (bool), Style (string) fields"
            - "Proper koanf tags: verbose, line_numbers, style"
            - "Struct documentation explains each field's purpose and default"
    - number: 2
      title: "Foundational"
      purpose: "Integrate CcleanConfig into Configuration struct and config system"
      tasks:
        - id: "T002"
          title: "Add CcleanConfig field to Configuration struct in internal/config/config.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: "internal/config/config.go"
          dependencies: ["T001"]
          acceptance_criteria:
            - "Cclean CcleanConfig field added to Configuration struct"
            - "Proper koanf tag: cclean"
            - "Field is embedded/nested correctly for hierarchical config"
        - id: "T003"
          title: "Add cclean keys to KnownKeys registry in internal/config/schema.go"
          status: "Completed"
          type: "implementation"
          parallel: true
          story_id: null
          file_path: "internal/config/schema.go"
          dependencies: ["T001"]
          acceptance_criteria:
            - "cclean.verbose key registered with bool type"
            - "cclean.line_numbers key registered with bool type"
            - "cclean.style key registered with string type and allowed values"
        - id: "T004"
          title: "Add default values for cclean config in internal/config/defaults.go"
          status: "Completed"
          type: "implementation"
          parallel: true
          story_id: null
          file_path: "internal/config/defaults.go"
          dependencies: ["T001"]
          acceptance_criteria:
            - "Default verbose=false"
            - "Default line_numbers=false"
            - "Default style=default"
            - "Environment variable support for AUTOSPEC_CCLEAN_VERBOSE, AUTOSPEC_CCLEAN_LINE_NUMBERS, AUTOSPEC_CCLEAN_STYLE"
    - number: 3
      title: "User Story 1 - Configure cclean options internally"
      purpose: "Enable developers to configure cclean behavior through internal configuration"
      story_reference: "US-001"
      independent_test: "Verify cclean options can be set via config file and env vars, and are correctly loaded into Configuration struct"
      tasks:
        - id: "T005"
          title: "Add tests for cclean config loading in internal/config/config_test.go"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: "US-001"
          file_path: "internal/config/config_test.go"
          dependencies: ["T002", "T003", "T004"]
          acceptance_criteria:
            - "Test cclean config loads from YAML file"
            - "Test cclean config loads from environment variables"
            - "Test hierarchical priority (env > project > user > defaults)"
            - "Test invalid style value falls back to default with warning"
            - "Map-based table-driven tests with t.Parallel()"
        - id: "T006"
          title: "Update StreamFormatter.mapStyleToConfig() to use CcleanConfig in internal/workflow/formatter.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: "US-001"
          file_path: "internal/workflow/formatter.go"
          dependencies: ["T005"]
          acceptance_criteria:
            - "mapStyleToConfig reads Configuration.Cclean.Verbose and applies to display.Config"
            - "mapStyleToConfig reads Configuration.Cclean.LineNumbers and applies to display.Config"
            - "mapStyleToConfig reads Configuration.Cclean.Style and applies to display.Config"
            - "Invalid style values log warning and fall back to default"
            - "Function remains <40 lines per PRIN-011"
        - id: "T007"
          title: "Add tests for cclean config application in internal/workflow/formatter_test.go"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: "US-001"
          file_path: "internal/workflow/formatter_test.go"
          dependencies: ["T006"]
          acceptance_criteria:
            - "Test verbose=true enables verbose output in display.Config"
            - "Test line_numbers=true enables line numbers in display.Config"
            - "Test each style value (default, compact, minimal, plain) maps correctly"
            - "Test invalid style falls back to default"
            - "Map-based table-driven tests with t.Parallel()"
    - number: 4
      title: "User Story 2 - View cclean arguments"
      purpose: "Enable developers to understand available cclean options through documentation"
      story_reference: "US-002"
      independent_test: "Verify documentation accurately lists all supported cclean arguments for version 0.2.0"
      tasks:
        - id: "T008"
          title: "Update docs/internal/cclean.md with configuration options"
          status: "Completed"
          type: "documentation"
          parallel: false
          story_id: "US-002"
          file_path: "docs/internal/cclean.md"
          dependencies: ["T006"]
          acceptance_criteria:
            - "Document cclean.verbose option with -V flag equivalent"
            - "Document cclean.line_numbers option with -n flag equivalent"
            - "Document cclean.style option with -s flag equivalent and allowed values"
            - "Include config file examples for project and user config"
            - "Include environment variable examples"
            - "Document default values and fallback behavior"
        - id: "T009"
          title: "Update config template in internal/config/defaults.go with cclean section comments"
          status: "Completed"
          type: "documentation"
          parallel: true
          story_id: "US-002"
          file_path: "internal/config/defaults.go"
          dependencies: ["T004"]
          acceptance_criteria:
            - "ConfigTemplate includes cclean section with commented examples"
            - "Each option has inline documentation"
            - "Template shows default values"
    - number: 5
      title: "Polish & Cross-Cutting Concerns"
      purpose: "Ensure edge cases are handled and validation is complete"
      tasks:
        - id: "T010"
          title: "Add edge case tests for invalid cclean config values"
          status: "Completed"
          type: "test"
          parallel: true
          story_id: null
          file_path: "internal/config/config_test.go"
          dependencies: ["T005", "T007"]
          acceptance_criteria:
            - "Test invalid style value (e.g., 'fancy') logs warning and uses default"
            - "Test non-boolean values for verbose/line_numbers are handled gracefully"
            - "Test empty string for style uses default"
        - id: "T011"
          title: "Verify cclean.style precedence over output_style"
          status: "Completed"
          type: "test"
          parallel: true
          story_id: null
          file_path: "internal/workflow/formatter_test.go"
          dependencies: ["T007"]
          acceptance_criteria:
            - "Test cclean.style takes precedence when both cclean.style and output_style are set"
            - "Test output_style is used as fallback when cclean.style is not set"
            - "Document precedence behavior in test comments"
        - id: "T012"
          title: "Run full test suite and verify no regressions"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: null
          file_path: null
          dependencies: ["T010", "T011"]
          acceptance_criteria:
            - "make test passes with no failures"
            - "make lint passes with no errors"
            - "make build succeeds"
            - "Existing cclean behavior unchanged when no config is set"
dependencies:
    user_story_order:
        - story_id: "US-001"
          depends_on: []
          blocks: ["US-002"]
        - story_id: "US-002"
          depends_on: ["US-001"]
          blocks: []
    phase_order:
        - phase: 1
          blocks: [2]
        - phase: 2
          blocks: [3, 4]
        - phase: 3
          blocks: [4, 5]
        - phase: 4
          blocks: [5]
parallel_execution:
    - phase: 2
      parallel_groups:
        - tasks: ["T003", "T004"]
          rationale: "schema.go and defaults.go are independent files with no cross-dependencies"
    - phase: 4
      parallel_groups:
        - tasks: ["T008", "T009"]
          rationale: "Documentation files are independent"
    - phase: 5
      parallel_groups:
        - tasks: ["T010", "T011"]
          rationale: "Different test files targeting different edge cases"
implementation_strategy:
    mvp_scope:
        phases: [1, 2, 3]
        description: "Setup + Foundational + User Story 1 (Configure cclean options)"
        validation: "Run tests and verify cclean options can be configured via config file and env vars"
    incremental_delivery:
        - milestone: "Foundation Ready"
          phases: [1, 2]
          deliverable: "CcleanConfig struct defined and integrated into config system"
        - milestone: "MVP Complete"
          phases: [1, 2, 3]
          deliverable: "Cclean options configurable through internal config; StreamFormatter uses settings"
        - milestone: "Full Feature"
          phases: [1, 2, 3, 4, 5]
          deliverable: "Complete cclean config with documentation and all edge cases handled"
_meta:
    version: "1.0.0"
    generator: "autospec"
    generator_version: "autospec v0.7.3"
    created: "2026-01-02T05:24:53Z"
    artifact_type: "tasks"
