tasks:
    branch: "053-dynamic-retry-instructions"
    created: "2025-12-18"
    spec_path: "specs/053-dynamic-retry-instructions/spec.yaml"
    plan_path: "specs/053-dynamic-retry-instructions/plan.yaml"
summary:
    total_tasks: 11
    total_phases: 4
    parallel_opportunities: 4
    estimated_complexity: "low"
phases:
    - number: 1
      title: "Setup"
      purpose: "Project initialization and define shared retry instructions constant"
      tasks:
        - id: "T001"
          title: "Add retryInstructions constant to internal/workflow/executor.go"
          status: "Completed"
          type: "setup"
          parallel: false
          story_id: null
          file_path: "internal/workflow/executor.go"
          dependencies: []
          acceptance_criteria:
            - "retryInstructions const is defined in executor.go"
            - "Contains generic retry handling documentation covering: detecting RETRY X/Y, parsing validation errors, common schema error fixes"
            - "Content is approximately 40-50 lines of markdown-formatted instructions"
    - number: 2
      title: "User Story 1 & 2 - Context-efficient execution and Retry-aware injection"
      purpose: "Implement dynamic retry instruction injection in FormatRetryContext"
      story_reference: "US-001, US-002"
      independent_test: "Run autospec specify on first run to verify no retry instructions; force a validation failure and verify retry includes instructions"
      tasks:
        - id: "T002"
          title: "Write tests for FormatRetryContext with instructions - internal/workflow/executor_test.go"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: "US-001"
          file_path: "internal/workflow/executor_test.go"
          dependencies: ["T001"]
          acceptance_criteria:
            - "Test case verifies FormatRetryContext with validation errors includes retryInstructions content"
            - "Test case verifies FormatRetryContext with empty errors does NOT include retryInstructions"
            - "Tests use map-based table-driven pattern with t.Parallel()"
        - id: "T003"
          title: "Modify FormatRetryContext to append retryInstructions - internal/workflow/executor.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: "US-002"
          file_path: "internal/workflow/executor.go"
          dependencies: ["T002"]
          acceptance_criteria:
            - "FormatRetryContext appends retryInstructions when validationErrors is non-empty"
            - "FormatRetryContext returns only RETRY X/Y when validationErrors is empty (no instructions)"
            - "Function remains under 40 lines"
            - "All existing tests pass"
    - number: 3
      title: "User Story 3 - Consistent retry instruction content"
      purpose: "Remove duplicated retry sections from command templates"
      story_reference: "US-003"
      independent_test: "Verify command template files no longer contain '## Retry Context' section"
      tasks:
        - id: "T004"
          title: "Remove '## Retry Context' section from internal/commands/autospec.specify.md"
          status: "Completed"
          type: "refactor"
          parallel: true
          story_id: "US-003"
          file_path: "internal/commands/autospec.specify.md"
          dependencies: ["T003"]
          acceptance_criteria:
            - "The '## Retry Context' heading and all subsections are removed"
            - "File remains valid markdown"
            - "No other sections are modified"
        - id: "T005"
          title: "Remove '## Retry Context' section from internal/commands/autospec.plan.md"
          status: "Completed"
          type: "refactor"
          parallel: true
          story_id: "US-003"
          file_path: "internal/commands/autospec.plan.md"
          dependencies: ["T003"]
          acceptance_criteria:
            - "The '## Retry Context' heading and all subsections are removed"
            - "File remains valid markdown"
            - "No other sections are modified"
        - id: "T006"
          title: "Remove '## Retry Context' section from internal/commands/autospec.tasks.md"
          status: "Completed"
          type: "refactor"
          parallel: true
          story_id: "US-003"
          file_path: "internal/commands/autospec.tasks.md"
          dependencies: ["T003"]
          acceptance_criteria:
            - "The '## Retry Context' heading and all subsections are removed"
            - "File remains valid markdown"
            - "No other sections are modified"
        - id: "T007"
          title: "Update existing FormatRetryContext tests to expect instructions - internal/workflow/executor_test.go"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: "US-003"
          file_path: "internal/workflow/executor_test.go"
          dependencies: ["T003"]
          acceptance_criteria:
            - "Existing TestFormatRetryContext test cases updated to expect instructions in output when errors present"
            - "Tests pass with the modified function behavior"
    - number: 4
      title: "Validation and Quality Gates"
      purpose: "Ensure all changes pass quality checks"
      tasks:
        - id: "T008"
          title: "Run make test and verify all tests pass"
          status: "InProgress"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: ""
          dependencies: ["T004", "T005", "T006", "T007"]
          acceptance_criteria:
            - "make test exits with code 0"
            - "All retry-related tests pass"
            - "No test regressions"
        - id: "T009"
          title: "Run make fmt and verify no formatting changes"
          status: "Pending"
          type: "implementation"
          parallel: true
          story_id: null
          file_path: ""
          dependencies: ["T008"]
          acceptance_criteria:
            - "make fmt exits with code 0"
            - "No files are modified by formatting"
        - id: "T010"
          title: "Run make lint and verify no lint errors"
          status: "Pending"
          type: "implementation"
          parallel: true
          story_id: null
          file_path: ""
          dependencies: ["T008"]
          acceptance_criteria:
            - "make lint exits with code 0"
            - "No lint warnings or errors"
        - id: "T011"
          title: "Run make build and verify successful compilation"
          status: "Pending"
          type: "implementation"
          parallel: true
          story_id: null
          file_path: ""
          dependencies: ["T008"]
          acceptance_criteria:
            - "make build exits with code 0"
            - "Binary is produced without errors"
dependencies:
    user_story_order:
        - story_id: "US-001"
          depends_on: []
          blocks: ["US-003"]
        - story_id: "US-002"
          depends_on: []
          blocks: ["US-003"]
        - story_id: "US-003"
          depends_on: ["US-001", "US-002"]
          blocks: []
    phase_order:
        - phase: 1
          blocks: [2]
        - phase: 2
          blocks: [3]
        - phase: 3
          blocks: [4]
parallel_execution:
    - phase: 3
      parallel_groups:
        - tasks: ["T004", "T005", "T006"]
          rationale: "Different files, no dependencies between them"
    - phase: 4
      parallel_groups:
        - tasks: ["T009", "T010", "T011"]
          rationale: "Independent quality gate checks after tests pass"
implementation_strategy:
    mvp_scope:
        phases: [1, 2]
        description: "Setup + FormatRetryContext modification - core functionality working"
        validation: "Run tests to verify retry context includes instructions when errors present"
    incremental_delivery:
        - milestone: "Foundation Ready"
          phases: [1]
          deliverable: "retryInstructions constant defined"
        - milestone: "Core Functionality"
          phases: [1, 2]
          deliverable: "FormatRetryContext dynamically injects instructions"
        - milestone: "Template Cleanup"
          phases: [1, 2, 3]
          deliverable: "Command templates no longer contain duplicated retry sections"
        - milestone: "Quality Verified"
          phases: [1, 2, 3, 4]
          deliverable: "All quality gates pass"
_meta:
    version: "1.0.0"
    generator: "autospec"
    generator_version: "autospec dev"
    created: "2025-12-18T20:49:08Z"
    artifact_type: "tasks"
