tasks:
    branch: "076-optional-risk-assessment"
    created: "2026-01-01"
    spec_path: "specs/076-optional-risk-assessment/spec.yaml"
    plan_path: "specs/076-optional-risk-assessment/plan.yaml"
summary:
    total_tasks: 13
    total_phases: 5
    parallel_opportunities: 4
    estimated_complexity: "low"
phases:
    - number: 1
      title: "Setup"
      purpose: "Verify project structure and existing patterns"
      tasks:
        - id: "T001"
          title: "Review existing InjectableInstruction pattern in autocommit.go"
          status: "Completed"
          type: "setup"
          parallel: false
          story_id: null
          file_path: "internal/workflow/autocommit.go"
          dependencies: []
          acceptance_criteria:
            - "Understand InjectableInstruction struct and BuildAutoCommitInstructions pattern"
            - "Identify injection point in executor for reference"
    - number: 2
      title: "Foundational"
      purpose: "Add configuration field that controls risk assessment behavior"
      tasks:
        - id: "T002"
          title: "Add EnableRiskAssessment field to Configuration struct"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: "internal/config/config.go"
          dependencies: ["T001"]
          acceptance_criteria:
            - "Configuration struct has EnableRiskAssessment bool field"
            - "Field has mapstructure tag 'enable_risk_assessment'"
            - "Default value is false"
        - id: "T003"
          title: "Add tests for EnableRiskAssessment config field"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: null
          file_path: "internal/config/config_test.go"
          dependencies: ["T002"]
          acceptance_criteria:
            - "Test verifies default value is false"
            - "Test verifies explicit true/false values are parsed correctly"
            - "Test verifies config priority (env > project > user > defaults)"
            - "Tests use map[string]struct pattern"
    - number: 3
      title: "User Story 1 & 2 - Risk Assessment Core"
      purpose: "Implement core risk assessment injection functionality"
      story_reference: "US-001, US-002"
      independent_test: "Run plan generation with default config (no risks section) and with enable_risk_assessment: true (risks section appears)"
      tasks:
        - id: "T004"
          title: "Create BuildRiskAssessmentInstructions function"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: "US-001"
          file_path: "internal/workflow/risk_assessment.go"
          dependencies: ["T002"]
          acceptance_criteria:
            - "Function returns InjectableInstruction struct"
            - "Name field is 'risk_assessment'"
            - "DisplayHint field is '[+RiskAssessment]'"
            - "Content includes risks YAML schema and guidance"
            - "Function is under 40 lines"
        - id: "T005"
          title: "Create InjectRiskAssessment helper function"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: "US-001"
          file_path: "internal/workflow/risk_assessment.go"
          dependencies: ["T004"]
          acceptance_criteria:
            - "Function signature: InjectRiskAssessment(command string, enabled bool) string"
            - "Returns unmodified command when enabled=false"
            - "Appends risk instructions to command when enabled=true"
            - "Function is under 40 lines"
        - id: "T006"
          title: "Add tests for risk_assessment.go functions"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: "US-001"
          file_path: "internal/workflow/risk_assessment_test.go"
          dependencies: ["T005"]
          acceptance_criteria:
            - "Test BuildRiskAssessmentInstructions returns valid InjectableInstruction"
            - "Test InjectRiskAssessment with enabled=false returns unchanged command"
            - "Test InjectRiskAssessment with enabled=true appends risk content"
            - "Tests use map[string]struct pattern"
        - id: "T007"
          title: "Remove risks section from embedded autospec.plan.md template"
          status: "Completed"
          type: "implementation"
          parallel: true
          story_id: "US-001"
          file_path: "internal/commands/autospec.plan.md"
          dependencies: ["T003"]
          acceptance_criteria:
            - "Template no longer contains hardcoded risks: section"
            - "Template remains valid and project-agnostic"
            - "YAML schema structure remains intact for other sections"
        - id: "T008"
          title: "Integrate risk injection into buildPlanCommand"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: "US-002"
          file_path: "internal/workflow/stage_executor.go"
          dependencies: ["T006", "T007"]
          acceptance_criteria:
            - "buildPlanCommand calls InjectRiskAssessment with config.EnableRiskAssessment"
            - "Injection happens after template loading, before command return"
            - "Function remains under 40 lines"
        - id: "T009"
          title: "Add integration tests for buildPlanCommand with risk assessment"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: "US-002"
          file_path: "internal/workflow/stage_executor_test.go"
          dependencies: ["T008"]
          acceptance_criteria:
            - "Test buildPlanCommand with EnableRiskAssessment=false excludes risk content"
            - "Test buildPlanCommand with EnableRiskAssessment=true includes risk content"
            - "Tests use map[string]struct pattern"
    - number: 4
      title: "User Story 3 - Verbose Indicator"
      purpose: "Visual feedback when risk assessment is injected"
      story_reference: "US-003"
      independent_test: "Run plan stage with verbose output and verify [+RiskAssessment] indicator appears when enabled"
      tasks:
        - id: "T010"
          title: "Ensure verbose mode displays [+RiskAssessment] indicator"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: "US-003"
          file_path: "internal/workflow/stage_executor.go"
          dependencies: ["T009"]
          acceptance_criteria:
            - "DisplayHint from InjectableInstruction is shown in verbose mode"
            - "Indicator only appears when EnableRiskAssessment=true"
            - "Follows same pattern as auto-commit indicator"
    - number: 5
      title: "Documentation"
      purpose: "Update documentation to explain opt-in risk assessment"
      tasks:
        - id: "T011"
          title: "Update docs/internal/risks.md with opt-in instructions"
          status: "Completed"
          type: "documentation"
          parallel: true
          story_id: null
          file_path: "docs/internal/risks.md"
          dependencies: ["T009"]
          acceptance_criteria:
            - "Document explains risk assessment is disabled by default"
            - "Document shows how to enable via config (project and user level)"
            - "Document includes example configuration YAML"
        - id: "T012"
          title: "Update docs/reference.md with enable_risk_assessment config option"
          status: "Completed"
          type: "documentation"
          parallel: true
          story_id: null
          file_path: "docs/reference.md"
          dependencies: ["T009"]
          acceptance_criteria:
            - "Config option listed in configuration reference section"
            - "Description explains purpose and default value (false)"
            - "Follows existing config option documentation format"
        - id: "T013"
          title: "Run quality gates: make test, make fmt, make lint, make build"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: "Makefile"
          dependencies: ["T010", "T011", "T012"]
          acceptance_criteria:
            - "make test passes with no failures"
            - "make fmt produces no changes"
            - "make lint produces no errors"
            - "make build succeeds"
dependencies:
    user_story_order:
        - story_id: "US-001"
          depends_on: []
          blocks: ["US-002"]
        - story_id: "US-002"
          depends_on: ["US-001"]
          blocks: ["US-003"]
        - story_id: "US-003"
          depends_on: ["US-002"]
          blocks: []
    phase_order:
        - phase: 1
          blocks: [2]
        - phase: 2
          blocks: [3]
        - phase: 3
          blocks: [4]
        - phase: 4
          blocks: [5]
parallel_execution:
    - phase: 3
      parallel_groups:
        - tasks: ["T007"]
          rationale: "Template modification independent of risk_assessment.go development"
    - phase: 5
      parallel_groups:
        - tasks: ["T011", "T012"]
          rationale: "Documentation files are independent of each other"
implementation_strategy:
    mvp_scope:
        phases: [1, 2, 3]
        description: "Setup + Config + Core risk assessment injection"
        validation: "Run plan generation with and without enable_risk_assessment config; verify risks section presence/absence"
    incremental_delivery:
        - milestone: "Config Ready"
          phases: [1, 2]
          deliverable: "EnableRiskAssessment config field with defaults and tests"
        - milestone: "MVP Complete"
          phases: [1, 2, 3]
          deliverable: "Fully functional opt-in risk assessment"
        - milestone: "Feature Complete"
          phases: [1, 2, 3, 4, 5]
          deliverable: "Complete feature with verbose indicator and documentation"
_meta:
    version: "1.0.0"
    generator: "autospec"
    generator_version: "autospec dev"
    created: "2026-01-01T20:40:31Z"
    artifact_type: "tasks"
