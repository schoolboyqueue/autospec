tasks:
    branch: "020-implement-phases-flag"
    created: "2025-12-16"
    spec_path: "specs/020-implement-phases-flag/spec.yaml"
    plan_path: "specs/020-implement-phases-flag/plan.yaml"
summary:
    total_tasks: 28
    total_phases: 6
    parallel_opportunities: 8
    estimated_complexity: "medium"
phases:
    - number: 1
      title: "Foundation - Phase Parsing and Validation"
      purpose: "Add functions to parse phase information from tasks.yaml and determine completion status"
      tasks:
        - id: "T001"
          title: "Add PhaseInfo struct and phase parsing to internal/validation/tasks_yaml.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: "internal/validation/tasks_yaml.go"
          dependencies: []
          acceptance_criteria:
            - "PhaseInfo struct with number, title, total_tasks, completed_tasks, blocked_tasks, actionable_tasks fields"
            - "GetPhaseInfo() function returns slice of PhaseInfo from tasks.yaml"
            - "Correctly counts task statuses (Pending, InProgress, Completed, Blocked)"
        - id: "T002"
          title: "Add IsPhaseComplete() function to internal/validation/tasks_yaml.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: "internal/validation/tasks_yaml.go"
          dependencies: ["T001"]
          acceptance_criteria:
            - "Returns true when all tasks are Completed or Blocked"
            - "Returns false when any task is Pending or InProgress"
            - "Handles empty phases (returns true)"
        - id: "T003"
          title: "Add GetActionablePhases() function to internal/validation/tasks_yaml.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: "internal/validation/tasks_yaml.go"
          dependencies: ["T001", "T002"]
          acceptance_criteria:
            - "Returns phases that have Pending or InProgress tasks"
            - "Filters out phases where all tasks are Completed or Blocked"
            - "Returns phases in original order (1, 2, 3...)"
        - id: "T004"
          title: "Add GetFirstIncompletePhase() function to internal/validation/tasks_yaml.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: "internal/validation/tasks_yaml.go"
          dependencies: ["T002", "T003"]
          acceptance_criteria:
            - "Returns the lowest phase number with incomplete tasks"
            - "Returns 0 and nil slice if all phases complete"
            - "Used for auto-resume from correct phase"
        - id: "T005"
          title: "Add unit tests for phase parsing functions in internal/validation/tasks_yaml_test.go"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: null
          file_path: "internal/validation/tasks_yaml_test.go"
          dependencies: ["T001", "T002", "T003", "T004"]
          acceptance_criteria:
            - "TestGetPhaseInfo with various task states"
            - "TestIsPhaseComplete with Completed/Blocked/Pending/InProgress combinations"
            - "TestGetActionablePhases with multiple phases"
            - "TestGetFirstIncompletePhase for auto-resume scenarios"
    - number: 2
      title: "State Management - Phase Tracking in Retry State"
      purpose: "Extend retry state to track phase-level execution progress"
      tasks:
        - id: "T006"
          title: "Add PhaseExecutionState struct to internal/retry/retry.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: "internal/retry/retry.go"
          dependencies: ["T001"]
          acceptance_criteria:
            - "PhaseExecutionState with spec_name, current_phase, total_phases, completed_phases, last_phase_attempt"
            - "JSON serialization tags for persistence"
            - "Embedded in RetryStore alongside existing Retries map"
        - id: "T007"
          title: "Add LoadPhaseState/SavePhaseState functions to internal/retry/retry.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: "internal/retry/retry.go"
          dependencies: ["T006"]
          acceptance_criteria:
            - "LoadPhaseState returns current phase execution state for spec"
            - "SavePhaseState persists phase state atomically via temp file + rename"
            - "Integrates with existing retry.json file structure"
        - id: "T008"
          title: "Add MarkPhaseComplete/ResetPhaseState functions to internal/retry/retry.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: "internal/retry/retry.go"
          dependencies: ["T007"]
          acceptance_criteria:
            - "MarkPhaseComplete adds phase number to completed_phases list"
            - "ResetPhaseState clears all phase tracking for a spec"
            - "Updates are persisted immediately"
        - id: "T009"
          title: "Add unit tests for phase state management in internal/retry/retry_test.go"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: null
          file_path: "internal/retry/retry_test.go"
          dependencies: ["T006", "T007", "T008"]
          acceptance_criteria:
            - "TestPhaseExecutionState serialization"
            - "TestLoadPhaseState/TestSavePhaseState roundtrip"
            - "TestMarkPhaseComplete updates correctly"
            - "TestResetPhaseState clears state"
    - number: 3
      title: "CLI Flags - Add Phase Selection Options"
      purpose: "Add --phases, --phase, and --from-phase flags to implement command"
      tasks:
        - id: "T010"
          title: "Add --phases boolean flag to internal/cli/implement.go"
          status: "Completed"
          type: "implementation"
          parallel: true
          story_id: "US-001"
          file_path: "internal/cli/implement.go"
          dependencies: ["T001"]
          acceptance_criteria:
            - "Flag defined: --phases (run all phases sequentially in separate sessions)"
            - "Help text explains fresh context per phase benefit"
            - "Short flag not needed (avoid collision)"
        - id: "T011"
          title: "Add --phase <number> flag to internal/cli/implement.go"
          status: "Completed"
          type: "implementation"
          parallel: true
          story_id: "US-002"
          file_path: "internal/cli/implement.go"
          dependencies: ["T001"]
          acceptance_criteria:
            - "Flag defined: --phase <number> (run only specific phase)"
            - "Validates phase number is positive integer"
            - "Help text explains single-phase execution use case"
        - id: "T012"
          title: "Add --from-phase <number> flag to internal/cli/implement.go"
          status: "Completed"
          type: "implementation"
          parallel: true
          story_id: "US-003"
          file_path: "internal/cli/implement.go"
          dependencies: ["T001"]
          acceptance_criteria:
            - "Flag defined: --from-phase <number> (run phases starting from N)"
            - "Validates phase number is positive integer"
            - "Help text explains resume use case"
        - id: "T013"
          title: "Add mutual exclusivity validation for phase flags in internal/cli/implement.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: "internal/cli/implement.go"
          dependencies: ["T010", "T011", "T012"]
          acceptance_criteria:
            - "MarkFlagsMutuallyExclusive for --phases, --phase, --from-phase"
            - "Clear error message when multiple flags used together"
            - "Exit code 3 for invalid arguments"
        - id: "T014"
          title: "Update implement command help text and examples in internal/cli/implement.go"
          status: "Completed"
          type: "documentation"
          parallel: false
          story_id: null
          file_path: "internal/cli/implement.go"
          dependencies: ["T013"]
          acceptance_criteria:
            - "Updated Long description with phase execution modes"
            - "Examples showing --phases, --phase 3, --from-phase 2"
            - "Clear explanation of backward compatible default"
        - id: "T015"
          title: "Add unit tests for CLI flag parsing in internal/cli/implement_test.go"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: null
          file_path: "internal/cli/implement_test.go"
          dependencies: ["T013", "T014"]
          acceptance_criteria:
            - "Test --phases flag sets correct boolean"
            - "Test --phase <N> parses integer correctly"
            - "Test --from-phase <N> parses integer correctly"
            - "Test mutual exclusivity produces error"
    - number: 4
      title: "Workflow Orchestration - Phased Execution"
      purpose: "Implement the core phased execution loop in workflow orchestrator"
      tasks:
        - id: "T016"
          title: "Create internal/workflow/phase_execution.go with helper structs"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: "internal/workflow/phase_execution.go"
          dependencies: ["T005", "T009", "T015"]
          acceptance_criteria:
            - "PhaseExecutionConfig struct for execution options"
            - "PhaseExecutionResult struct for phase completion status"
            - "Constants for phase execution modes (All, Single, FromPhase)"
        - id: "T017"
          title: "Add ExecuteImplementWithPhases() to internal/workflow/workflow.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: "US-001"
          file_path: "internal/workflow/workflow.go"
          dependencies: ["T016"]
          acceptance_criteria:
            - "Loops through all phases in tasks.yaml"
            - "Starts fresh Claude session for each phase"
            - "Auto-resumes from first incomplete phase"
            - "Displays 'Phases 1-N complete, starting from phase M' when skipping"
        - id: "T018"
          title: "Add ExecuteImplementSinglePhase() to internal/workflow/workflow.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: "US-002"
          file_path: "internal/workflow/workflow.go"
          dependencies: ["T016"]
          acceptance_criteria:
            - "Executes only the specified phase number"
            - "Validates phase exists in tasks.yaml"
            - "Returns clear error for invalid phase number"
        - id: "T019"
          title: "Add ExecuteImplementFromPhase() to internal/workflow/workflow.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: "US-003"
          file_path: "internal/workflow/workflow.go"
          dependencies: ["T016"]
          acceptance_criteria:
            - "Executes phases starting from specified number"
            - "Each phase in fresh Claude session"
            - "Validates starting phase exists"
        - id: "T020"
          title: "Add phase completion validation between transitions"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: "internal/workflow/workflow.go"
          dependencies: ["T017", "T018", "T019"]
          acceptance_criteria:
            - "Validates all phase tasks complete before moving to next"
            - "Treats Blocked tasks as complete (non-actionable)"
            - "Returns error if validation fails"
        - id: "T021"
          title: "Add progress display showing current phase in internal/workflow/workflow.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: "US-005"
          file_path: "internal/workflow/workflow.go"
          dependencies: ["T020"]
          acceptance_criteria:
            - "Displays 'Phase X/Y: Phase Name' format"
            - "Progress visible within 2 seconds of phase transition"
            - "Uses existing spinner/progress display patterns"
        - id: "T022"
          title: "Update ExecuteImplement() to dispatch to phased execution in internal/workflow/workflow.go"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: "US-004"
          file_path: "internal/workflow/workflow.go"
          dependencies: ["T017", "T018", "T019", "T020", "T021"]
          acceptance_criteria:
            - "Default (no flags) calls existing single-session logic"
            - "--phases calls ExecuteImplementWithPhases()"
            - "--phase N calls ExecuteImplementSinglePhase(N)"
            - "--from-phase N calls ExecuteImplementFromPhase(N)"
            - "Backward compatible with existing workflows"
        - id: "T023"
          title: "Add integration tests for phased workflow in internal/workflow/workflow_test.go"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: null
          file_path: "internal/workflow/workflow_test.go"
          dependencies: ["T022"]
          acceptance_criteria:
            - "TestExecuteImplementWithPhases with multiple phases"
            - "TestExecuteImplementSinglePhase for specific phase"
            - "TestExecuteImplementFromPhase for partial execution"
            - "TestBackwardCompatibility for default behavior"
    - number: 5
      title: "Slash Command - Phase Filter Support"
      purpose: "Update /autospec.implement to accept optional phase parameter"
      tasks:
        - id: "T024"
          title: "Update .claude/commands/autospec.implement.md to accept phase filter"
          status: "Completed"
          type: "implementation"
          parallel: false
          story_id: null
          file_path: ".claude/commands/autospec.implement.md"
          dependencies: ["T022"]
          acceptance_criteria:
            - "Accepts optional --phase <N> argument"
            - "When phase specified, only execute tasks in that phase"
            - "Display which phase is being executed"
            - "Task filtering respects phase boundary"
    - number: 6
      title: "Polish & Documentation"
      purpose: "Update documentation and handle all edge cases"
      tasks:
        - id: "T025"
          title: "Update CLAUDE.md with new phase flags documentation"
          status: "Completed"
          type: "documentation"
          parallel: true
          story_id: null
          file_path: "CLAUDE.md"
          dependencies: ["T023", "T024"]
          acceptance_criteria:
            - "Document --phases, --phase, --from-phase flags"
            - "Add examples in CLI usage section"
            - "Explain when to use each mode"
        - id: "T026"
          title: "Add edge case handling for invalid phase numbers"
          status: "Completed"
          type: "implementation"
          parallel: true
          story_id: null
          file_path: "internal/workflow/workflow.go"
          dependencies: ["T022"]
          acceptance_criteria:
            - "Clear error for phase number > total phases"
            - "Clear error for phase number < 1"
            - "Exit code 3 for invalid arguments"
        - id: "T027"
          title: "Add edge case handling for empty/single phases"
          status: "Completed"
          type: "implementation"
          parallel: true
          story_id: null
          file_path: "internal/workflow/workflow.go"
          dependencies: ["T022"]
          acceptance_criteria:
            - "Skip empty phases with informational message"
            - "Single-phase tasks.yaml works with --phases"
            - "Legacy format (no phases) treats all as phase 1"
        - id: "T028"
          title: "Run make fmt and verify all tests pass"
          status: "Completed"
          type: "test"
          parallel: false
          story_id: null
          file_path: "Makefile"
          dependencies: ["T025", "T026", "T027"]
          acceptance_criteria:
            - "make fmt runs without changes needed"
            - "make test passes all tests"
            - "No linting errors"
dependencies:
    user_story_order:
        - story_id: "US-001"
          depends_on: []
          blocks: []
        - story_id: "US-002"
          depends_on: []
          blocks: []
        - story_id: "US-003"
          depends_on: []
          blocks: []
        - story_id: "US-004"
          depends_on: ["US-001", "US-002", "US-003"]
          blocks: []
        - story_id: "US-005"
          depends_on: ["US-001"]
          blocks: []
    phase_order:
        - phase: 1
          blocks: [2, 3, 4]
        - phase: 2
          blocks: [4]
        - phase: 3
          blocks: [4]
        - phase: 4
          blocks: [5, 6]
        - phase: 5
          blocks: [6]
        - phase: 6
          blocks: []
parallel_execution:
    - phase: 3
      parallel_groups:
        - tasks: ["T010", "T011", "T012"]
          rationale: "Different flags, no code dependencies between them"
    - phase: 6
      parallel_groups:
        - tasks: ["T025", "T026", "T027"]
          rationale: "Different concerns: documentation, error handling for phase bounds, edge cases"
implementation_strategy:
    mvp_scope:
        phases: [1, 2, 3, 4]
        description: "Phase parsing + state management + CLI flags + core workflow orchestration"
        validation: "autospec implement --phases executes phases sequentially with fresh contexts"
    incremental_delivery:
        - milestone: "Foundation Ready"
          phases: [1, 2]
          deliverable: "Phase parsing and state tracking infrastructure"
        - milestone: "CLI Flags Ready"
          phases: [1, 2, 3]
          deliverable: "Flags available but not yet wired to execution"
        - milestone: "Core Feature Complete"
          phases: [1, 2, 3, 4]
          deliverable: "Full phased execution working"
        - milestone: "Feature Complete"
          phases: [1, 2, 3, 4, 5, 6]
          deliverable: "Slash command support, documentation, edge cases handled"
_meta:
    version: "1.0.0"
    generator: "autospec"
    generator_version: "autospec dev"
    created: "2025-12-16T07:28:55Z"
    artifact_type: "tasks"
